\hypertarget{ceforth_8cpp}{}\doxysection{src/ceforth.cpp File Reference}
\label{ceforth_8cpp}\index{src/ceforth.cpp@{src/ceforth.cpp}}


e\+Forth implemented in 100\% C/\+C++ for portability and education  


{\ttfamily \#include $<$strings.\+h$>$}\newline
{\ttfamily \#include \char`\"{}ceforth.\+h\char`\"{}}\newline
{\ttfamily \#include $<$iostream$>$}\newline
{\ttfamily \#include $<$iomanip$>$}\newline
{\ttfamily \#include $<$sstream$>$}\newline
Include dependency graph for ceforth.\+cpp\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{ceforth_8cpp__incl}
\end{center}
\end{figure}
\doxysubsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \mbox{\hyperlink{ceforth_8cpp_a99cca8c766bbb673859637a1cf1f1150}{D\+I\+S\+P\+A\+T\+CH}}(op)~switch(op)
\item 
\#define \mbox{\hyperlink{ceforth_8cpp_af65ce469bd4158499d1024818862e4dc}{C\+A\+SE}}(op,  g)~case op \+: \{ g; \} break
\item 
\#define \mbox{\hyperlink{ceforth_8cpp_a323b79d06bef13e322d167f6bcd1551a}{O\+T\+H\+ER}}(g)~default \+: \{ g; \} break
\item 
\#define \mbox{\hyperlink{ceforth_8cpp_afe653f1b559a004a35dc3cbeed40a25d}{U\+N\+N\+E\+ST}}()~(\mbox{\hyperlink{ceforth_8cpp_a170318f415c56c413f6f4b7128d5f108}{VM}} = (\mbox{\hyperlink{ceforth_8cpp_afbbad1e6f5dfbd3664246a4a3a623559}{IP}}=\mbox{\hyperlink{config_8h_a7b3b4f9835caaf6be7bfa7f843bbec05}{U\+I\+NT}}(rs.\+pop())) ? \mbox{\hyperlink{ceforth_8cpp_a0f69c35de808703dbcaf85edc29cd4bfa9cfa27b414cab750fb14ec07cdf5cf6a}{H\+O\+LD}} \+: \mbox{\hyperlink{ceforth_8cpp_a0f69c35de808703dbcaf85edc29cd4bfa679ee5320d66c8322e310daeb2ee99b8}{S\+T\+OP}})
\end{DoxyCompactItemize}
\begin{Indent}\textbf{ Dictionary and data stack access macros}\par
{\em \begin{quote}
Macros to abstract dict and pmem physical implementation \end{quote}
Note\+: so we can change pmem implementation anytime without affecting opcodes defined below }\begin{DoxyCompactItemize}
\item 
\#define \mbox{\hyperlink{ceforth_8cpp_a1f75956c7e91b6411417071ea93f7bfe}{B\+O\+OL}}(f)~((f)?-\/1\+:0)
\item 
\#define \mbox{\hyperlink{ceforth_8cpp_a3fe03e23176f4fe277d1d3b41f3d3d06}{H\+E\+RE}}~(pmem.\+idx)
\item 
\#define \mbox{\hyperlink{ceforth_8cpp_a210af1d04c8870416a556f0e9a5194fd}{L\+A\+ST}}~(\mbox{\hyperlink{ceforth_8cpp_aa086a2419b6fa4292fe7a96ade49cfd4}{dict}}\mbox{[}dict.\+idx-\/1\mbox{]})
\item 
\#define \mbox{\hyperlink{ceforth_8cpp_a3eb1d48054595d728e295909b0bd07a6}{M\+EM}}(a)~(\mbox{\hyperlink{ceforth_8cpp_aba2779b6f01bb7f61e36d7bc577bb2aa}{M\+E\+M0}} + (\mbox{\hyperlink{config_8h_aff5e3e5f0579f9bce7aeaeac9d89d33a}{IU}})\mbox{\hyperlink{config_8h_a7b3b4f9835caaf6be7bfa7f843bbec05}{U\+I\+NT}}(a))
\item 
\#define \mbox{\hyperlink{ceforth_8cpp_a278f9ef19c0a24da568b7bfa81e666f6}{I\+G\+ET}}(ip)~($\ast$(\mbox{\hyperlink{config_8h_aff5e3e5f0579f9bce7aeaeac9d89d33a}{IU}}$\ast$)\mbox{\hyperlink{ceforth_8cpp_a3eb1d48054595d728e295909b0bd07a6}{M\+EM}}(ip))
\item 
\#define \mbox{\hyperlink{ceforth_8cpp_abc4b981c6dc73973a1fba2c05b54b1bd}{C\+E\+LL}}(a)~($\ast$(\mbox{\hyperlink{config_8h_a57c78d17a8f015df496afc50c9ab973d}{DU}}$\ast$)\&\mbox{\hyperlink{ceforth_8cpp_ad2bf19bcc0873d759b452babdb340575}{pmem}}\mbox{[}a\mbox{]})
\item 
\#define \mbox{\hyperlink{ceforth_8cpp_aedb0320e993911a93a9d9c587dea3f00}{S\+E\+T\+J\+MP}}(a)~($\ast$(\mbox{\hyperlink{config_8h_aff5e3e5f0579f9bce7aeaeac9d89d33a}{IU}}$\ast$)\&\mbox{\hyperlink{ceforth_8cpp_ad2bf19bcc0873d759b452babdb340575}{pmem}}\mbox{[}a\mbox{]} = \mbox{\hyperlink{ceforth_8cpp_a3fe03e23176f4fe277d1d3b41f3d3d06}{H\+E\+RE}})
\end{DoxyCompactItemize}
\end{Indent}
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{ceforth_8cpp_a5fdde0871776510df64f500650209b27}{P\+U\+SH}} (\mbox{\hyperlink{config_8h_a57c78d17a8f015df496afc50c9ab973d}{DU}} v)
\item 
\mbox{\hyperlink{config_8h_a57c78d17a8f015df496afc50c9ab973d}{DU}} \mbox{\hyperlink{ceforth_8cpp_ac84ee2b65e9f8a8a435a447462c6d6a0}{P\+OP}} ()
\item 
void \mbox{\hyperlink{ceforth_8cpp_ad846502b6abc77557b95ffb1d08699cc}{nest}} ()
\item 
void \mbox{\hyperlink{ceforth_8cpp_a724b39fd304fec7d17cfd9af5171683f}{C\+A\+LL}} (\mbox{\hyperlink{config_8h_aff5e3e5f0579f9bce7aeaeac9d89d33a}{IU}} w)
\item 
void \mbox{\hyperlink{ceforth_8cpp_a3b21cefa3dc7cbff6e06fedf876f0f3a}{load}} (const char $\ast$fn)
\item 
void \mbox{\hyperlink{ceforth_8cpp_af778fbbfe8f4407700d6f0b6a5c3fa09}{dict\+\_\+validate}} ()
\item 
\mbox{\hyperlink{config_8h_a57c78d17a8f015df496afc50c9ab973d}{DU}} \mbox{\hyperlink{ceforth_8cpp_af4d8edffd9e7bdec7cabac4227a9a4f1}{parse\+\_\+number}} (const char $\ast$idiom, int $\ast$err)
\item 
void \mbox{\hyperlink{ceforth_8cpp_a1238c49b581d1d9fc9908f87f645a136}{forth\+\_\+core}} (const char $\ast$idiom)
\item 
void \mbox{\hyperlink{ceforth_8cpp_a7f66d1cf6a56ed50c9abd5331ed2073e}{forth\+\_\+init}} ()
\item 
int \mbox{\hyperlink{ceforth_8cpp_abe1f9e941c1425c4edb59d5e2269ae59}{forth\+\_\+vm}} (const char $\ast$line, void($\ast$hook)(int, const char $\ast$))
\item 
void \mbox{\hyperlink{ceforth_8cpp_a05e51dee76eecef6d8eb2a7b7f99466b}{outer}} (istream \&in)
\begin{DoxyCompactList}\small\item\em load external Forth script \end{DoxyCompactList}\item 
int \mbox{\hyperlink{ceforth_8cpp_adacbe0175a79dff748855d8c9839f82b}{main}} (int ac, char $\ast$av\mbox{[}$\,$\mbox{]})
\end{DoxyCompactItemize}
\begin{Indent}\textbf{ Dictionary search functions -\/ can be adapted for R\+O\+M+\+R\+AM}\par
{\em \DoxyHorRuler{0}
 }\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{config_8h_aff5e3e5f0579f9bce7aeaeac9d89d33a}{IU}} \mbox{\hyperlink{ceforth_8cpp_a9101adddcefa40443edb8cfd578f5fc2}{find}} (const char $\ast$s)
\end{DoxyCompactItemize}
\end{Indent}
\begin{Indent}\textbf{ Colon word compiler}\par
{\em 
\begin{DoxyItemize}
\item we separate dict and pmem space to make word uniform in size
\item if they are combined then can behaves similar to classic Forth
\item with an addition link field added. 
\end{DoxyItemize}}\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{ceforth_8cpp_a2ea8f3d3b90031d767bd8abc9d47daa1}{colon}} (const char $\ast$name)
\item 
int \mbox{\hyperlink{ceforth_8cpp_aed1e848eb616f3919d0a9bb06453695e}{add\+\_\+str}} (const char $\ast$s)
\item 
void \mbox{\hyperlink{ceforth_8cpp_a6501518596206111ab40166b28ac6ae1}{add\+\_\+w}} (\mbox{\hyperlink{config_8h_aff5e3e5f0579f9bce7aeaeac9d89d33a}{IU}} w)
\item 
void \mbox{\hyperlink{ceforth_8cpp_a7775cab16db630b8457bdb457a8644f4}{add\+\_\+var}} (\mbox{\hyperlink{config_8h_aff5e3e5f0579f9bce7aeaeac9d89d33a}{IU}} op, \mbox{\hyperlink{config_8h_a57c78d17a8f015df496afc50c9ab973d}{DU}} v=\mbox{\hyperlink{config_8h_ab09a231138adc0fb73bfb9ba7144b797}{D\+U0}})
\item 
int \mbox{\hyperlink{ceforth_8cpp_aaa0fe6aede838886c3897f55c3d28ddd}{def\+\_\+word}} (const char $\ast$name)
\item 
char $\ast$ \mbox{\hyperlink{ceforth_8cpp_af629538f3b0c84bcc653fb92698c4f05}{word}} ()
\item 
void \mbox{\hyperlink{ceforth_8cpp_a912b572f7c21344049788c2faebd9f82}{s\+\_\+quote}} (\mbox{\hyperlink{ceforth_8h_af99290ebc7dc90e2d53b08b8445f90cf}{prim\+\_\+op}} op)
\end{DoxyCompactItemize}
\end{Indent}
\doxysubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{structList}{List}}$<$ \mbox{\hyperlink{config_8h_a57c78d17a8f015df496afc50c9ab973d}{DU}}, \mbox{\hyperlink{config_8h_a5f69a406901fcf08ab5615294d7f334a}{E4\+\_\+\+R\+S\+\_\+\+SZ}} $>$ \mbox{\hyperlink{ceforth_8cpp_a624ee54d8d2274faa869f5908ce720a5}{rs}}
\begin{DoxyCompactList}\small\item\em return stack \end{DoxyCompactList}\item 
\mbox{\hyperlink{structList}{List}}$<$ \mbox{\hyperlink{config_8h_a57c78d17a8f015df496afc50c9ab973d}{DU}}, \mbox{\hyperlink{config_8h_af9fc7bdce59a3dac7fa463f733c888cf}{E4\+\_\+\+S\+S\+\_\+\+SZ}} $>$ \mbox{\hyperlink{ceforth_8cpp_a7dca0eae5111fa9214a2e2598f5a96b0}{ss}}
\begin{DoxyCompactList}\small\item\em parameter stack \end{DoxyCompactList}\item 
\mbox{\hyperlink{structList}{List}}$<$ \mbox{\hyperlink{structCode}{Code}}, \mbox{\hyperlink{config_8h_a3663378c5ef858dd03bc28732c610758}{E4\+\_\+\+D\+I\+C\+T\+\_\+\+SZ}} $>$ \mbox{\hyperlink{ceforth_8cpp_aa086a2419b6fa4292fe7a96ade49cfd4}{dict}}
\begin{DoxyCompactList}\small\item\em dictionary \end{DoxyCompactList}\item 
\mbox{\hyperlink{structList}{List}}$<$ \mbox{\hyperlink{config_8h_aa63ef7b996d5487ce35a5a66601f3e73}{U8}}, \mbox{\hyperlink{config_8h_a0a0ff68a63bb8a53d930d405fe8624f8}{E4\+\_\+\+P\+M\+E\+M\+\_\+\+SZ}} $>$ \mbox{\hyperlink{ceforth_8cpp_ad2bf19bcc0873d759b452babdb340575}{pmem}}
\begin{DoxyCompactList}\small\item\em parameter memory (for colon definitions) \end{DoxyCompactList}\item 
\mbox{\hyperlink{config_8h_aa63ef7b996d5487ce35a5a66601f3e73}{U8}} $\ast$ \mbox{\hyperlink{ceforth_8cpp_aba2779b6f01bb7f61e36d7bc577bb2aa}{M\+E\+M0}} = \&\mbox{\hyperlink{ceforth_8cpp_ad2bf19bcc0873d759b452babdb340575}{pmem}}\mbox{[}0\mbox{]}
\end{DoxyCompactItemize}
\doxysubsection*{Primitive words}
\begin{DoxyCompactItemize}
\item 
\#define \mbox{\hyperlink{ceforth_8cpp_a76706a11ce64f9e12be4070f3832c1e6}{D\+I\+CT}}(w)~(\mbox{\hyperlink{ceforth_8h_a24fba804f04a45a65e1de9174fc1d839}{I\+S\+\_\+\+P\+R\+IM}}(w) ? \mbox{\hyperlink{ceforth_8cpp_a55a769ec05dd5b5b7b6295534541f6bc}{prim}}\mbox{[}w \& $\sim$\mbox{\hyperlink{ceforth_8h_aec92280c39d2b899a51e92addf82ea7e}{E\+X\+T\+\_\+\+F\+L\+AG}}\mbox{]} \+: \mbox{\hyperlink{ceforth_8cpp_aa086a2419b6fa4292fe7a96ade49cfd4}{dict}}\mbox{[}w\mbox{]})
\item 
\mbox{\hyperlink{structCode}{Code}} \mbox{\hyperlink{ceforth_8cpp_a55a769ec05dd5b5b7b6295534541f6bc}{prim}} \mbox{[}$\,$\mbox{]}
\end{DoxyCompactItemize}
\doxysubsection*{VM states and state variables}
\label{_amgrpb10b4f9668c814f4c6709cd4adc5eb78}%
 \begin{DoxyCompactItemize}
\item 
enum \mbox{\hyperlink{ceforth_8cpp_a0f69c35de808703dbcaf85edc29cd4bf}{vm\+\_\+state}} \{ \newline
\mbox{\hyperlink{ceforth_8cpp_a0f69c35de808703dbcaf85edc29cd4bfa679ee5320d66c8322e310daeb2ee99b8}{S\+T\+OP}} =0, 
\mbox{\hyperlink{ceforth_8cpp_a0f69c35de808703dbcaf85edc29cd4bfa9cfa27b414cab750fb14ec07cdf5cf6a}{H\+O\+LD}}, 
\mbox{\hyperlink{ceforth_8cpp_a0f69c35de808703dbcaf85edc29cd4bfa21043ddfa5289b4cf14cd4e3f5a89b62}{Q\+U\+E\+RY}}, 
\mbox{\hyperlink{ceforth_8cpp_a0f69c35de808703dbcaf85edc29cd4bfa5f0b5e8a99b9441721ea34f14ccc60fe}{N\+E\+ST}}, 
\newline
\mbox{\hyperlink{ceforth_8cpp_a0f69c35de808703dbcaf85edc29cd4bfaedd9974ef2207e0a03e0717dcb9e2269}{IO}}
 \}
\item 
\mbox{\hyperlink{config_8h_aff5e3e5f0579f9bce7aeaeac9d89d33a}{IU}} \mbox{\hyperlink{ceforth_8cpp_afbbad1e6f5dfbd3664246a4a3a623559}{IP}} = 0
\begin{DoxyCompactList}\small\item\em instruction pointer \end{DoxyCompactList}\item 
\mbox{\hyperlink{ceforth_8cpp_a0f69c35de808703dbcaf85edc29cd4bf}{vm\+\_\+state}} \mbox{\hyperlink{ceforth_8cpp_a170318f415c56c413f6f4b7128d5f108}{VM}} = \mbox{\hyperlink{ceforth_8cpp_a0f69c35de808703dbcaf85edc29cd4bfa21043ddfa5289b4cf14cd4e3f5a89b62}{Q\+U\+E\+RY}}
\item 
\mbox{\hyperlink{config_8h_a57c78d17a8f015df496afc50c9ab973d}{DU}} \mbox{\hyperlink{ceforth_8cpp_aa6a7d418e86b1d2fb92e4c941bae302a}{tos}} = -\/\mbox{\hyperlink{config_8h_a8f5350b752d7bf33f51b37b7c8e71abc}{D\+U1}}
\begin{DoxyCompactList}\small\item\em top of stack (cached) \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{ceforth_8cpp_aef05b34af1a92f91c23c8fde1941e5a8}{compile}} = false
\begin{DoxyCompactList}\small\item\em compiler flag \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{ceforth_8cpp_a088210e30aca67b4f3d3808157ce57d7}{upper}} = false
\begin{DoxyCompactList}\small\item\em case sensitivity control \end{DoxyCompactList}\item 
\mbox{\hyperlink{config_8h_aff5e3e5f0579f9bce7aeaeac9d89d33a}{IU}} \mbox{\hyperlink{ceforth_8cpp_a5d8850fc43ae60a32d6a9b48d9265fcf}{load\+\_\+dp}} = 0
\begin{DoxyCompactList}\small\item\em depth of recursive include \end{DoxyCompactList}\item 
\mbox{\hyperlink{config_8h_aff5e3e5f0579f9bce7aeaeac9d89d33a}{IU}} $\ast$ \mbox{\hyperlink{ceforth_8cpp_a5c4fb4ae8c722cd91ed47503b8aaaded}{base}}
\begin{DoxyCompactList}\small\item\em numeric radix (a pointer) \end{DoxyCompactList}\item 
\mbox{\hyperlink{config_8h_aff5e3e5f0579f9bce7aeaeac9d89d33a}{IU}} $\ast$ \mbox{\hyperlink{ceforth_8cpp_ad1fe51c8db7e234768405202eb6cc339}{dflt}}
\begin{DoxyCompactList}\small\item\em use float data unit flag \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{IO functions}
\label{_amgrpe86ec7fe5f4d3cb75d649ce39688962e}%
-\/ C++ standard template libraries used for core IO functions

====================================================================

\begin{DoxyNote}{Note}

\begin{DoxyItemize}
\item we use S\+TL for its syntaxial convinence, but
\item if it takes too much memory for target M\+CU,
\item these functions can be replaced with our own implementation 
\end{DoxyItemize}
\end{DoxyNote}
\begin{DoxyCompactItemize}
\item 
istringstream \mbox{\hyperlink{ceforth_8cpp_ab83f60d10ba1fbda9fafd4eb249b9689}{fin}}
\begin{DoxyCompactList}\small\item\em default to C++ standard template library \end{DoxyCompactList}\item 
ostringstream \mbox{\hyperlink{ceforth_8cpp_aa8d01c5367bd4ece39c7443bc4a06663}{fout}}
\begin{DoxyCompactList}\small\item\em forth\+\_\+out \end{DoxyCompactList}\item 
string \mbox{\hyperlink{ceforth_8cpp_a6e3effe75730089085c31e8396cf80a0}{pad}}
\begin{DoxyCompactList}\small\item\em input string buffer \end{DoxyCompactList}\item 
void($\ast$ \mbox{\hyperlink{ceforth_8cpp_ae601152c2463f358fc585f95817fb315}{fout\+\_\+cb}} )(int, const char $\ast$)
\begin{DoxyCompactList}\small\item\em forth output callback function (see E\+N\+DL macro) \end{DoxyCompactList}\item 
void \mbox{\hyperlink{ceforth_8cpp_a1edeac2b9a9f3903fcf20538b18e9ee4}{fin\+\_\+setup}} (const char $\ast$line)
\item 
void \mbox{\hyperlink{ceforth_8cpp_abd89dd3df33c460274765e882a8f156c}{fout\+\_\+setup}} (void($\ast$hook)(int, const char $\ast$))
\item 
char $\ast$ \mbox{\hyperlink{ceforth_8cpp_a6f241997f1fbe0bb5ddde7d646f96a4c}{scan}} (char c)
\begin{DoxyCompactList}\small\item\em scan input stream for a given char \end{DoxyCompactList}\item 
int \mbox{\hyperlink{ceforth_8cpp_a7b6f338854360679dc3bb527a89e43fb}{fetch}} (string \&idiom)
\begin{DoxyCompactList}\small\item\em read input stream into string \end{DoxyCompactList}\item 
void \mbox{\hyperlink{ceforth_8cpp_a59a029cd22163e0e580d06b4bc9b93e3}{spaces}} (int n)
\begin{DoxyCompactList}\small\item\em show spaces \end{DoxyCompactList}\item 
void \mbox{\hyperlink{ceforth_8cpp_a8ce34dd2181a4dc960b6cb73061e2891}{put}} (\mbox{\hyperlink{ceforth_8h_a30d7a36b04fcbc60a9c39e64ac64b27d}{io\+\_\+op}} op, \mbox{\hyperlink{config_8h_a57c78d17a8f015df496afc50c9ab973d}{DU}} v, \mbox{\hyperlink{config_8h_a57c78d17a8f015df496afc50c9ab973d}{DU}} v2)
\begin{DoxyCompactList}\small\item\em print literals \end{DoxyCompactList}\item 
void \mbox{\hyperlink{ceforth_8cpp_a1edbf4fc6ff6a98a4319552fa601dc56}{pstr}} (const char $\ast$str, \mbox{\hyperlink{ceforth_8h_a30d7a36b04fcbc60a9c39e64ac64b27d}{io\+\_\+op}} op)
\end{DoxyCompactItemize}
\doxysubsection*{Debug functions}
\label{_amgrpae38abbdf9691b5e797763034f4bab58}%
 \begin{DoxyCompactItemize}
\item 
\#define \mbox{\hyperlink{ceforth_8cpp_a50a5b647d9188740e7087eb7cd1472c7}{T\+O\+N\+A\+ME}}(w)~(\mbox{\hyperlink{ceforth_8cpp_aa086a2419b6fa4292fe7a96ade49cfd4}{dict}}\mbox{[}w\mbox{]}.pfa -\/ \mbox{\hyperlink{config_8h_a916ffefe1fc74532d08102cca55d8e34}{S\+T\+R\+L\+EN}}(\mbox{\hyperlink{ceforth_8cpp_aa086a2419b6fa4292fe7a96ade49cfd4}{dict}}\mbox{[}w\mbox{]}.name))
\item 
int \mbox{\hyperlink{ceforth_8cpp_a0a04f8d7424b20a976b85a0757b07d5e}{pfa2didx}} (\mbox{\hyperlink{config_8h_aff5e3e5f0579f9bce7aeaeac9d89d33a}{IU}} ix)
\item 
int \mbox{\hyperlink{ceforth_8cpp_ac825b190b7185ebb634231d8edfdafcc}{pfa2allot}} (\mbox{\hyperlink{config_8h_aff5e3e5f0579f9bce7aeaeac9d89d33a}{IU}} pfa)
\item 
void \mbox{\hyperlink{ceforth_8cpp_ad98562c5319efcd96d89f375ed173507}{to\+\_\+s}} (\mbox{\hyperlink{config_8h_aff5e3e5f0579f9bce7aeaeac9d89d33a}{IU}} w, \mbox{\hyperlink{config_8h_aa63ef7b996d5487ce35a5a66601f3e73}{U8}} $\ast$ip)
\item 
void \mbox{\hyperlink{ceforth_8cpp_ac7375936d290f4dd3ded50a68694551e}{see}} (\mbox{\hyperlink{config_8h_aff5e3e5f0579f9bce7aeaeac9d89d33a}{IU}} pfa)
\begin{DoxyCompactList}\small\item\em disassemble user defined word \end{DoxyCompactList}\item 
void \mbox{\hyperlink{ceforth_8cpp_a8c226ea3e83d7102f33d1575b060f511}{words}} ()
\begin{DoxyCompactList}\small\item\em list dictionary words \end{DoxyCompactList}\item 
void \mbox{\hyperlink{ceforth_8cpp_a582bfd1eea6baf2a28d214ff77bc193c}{ss\+\_\+dump}} (bool forced)
\begin{DoxyCompactList}\small\item\em show data stack content \end{DoxyCompactList}\item 
void \mbox{\hyperlink{ceforth_8cpp_a00606e924aae9ae9ad50a618443a7847}{mem\+\_\+dump}} (\mbox{\hyperlink{config_8h_a696390429f2f3b644bde8d0322a24124}{U32}} p0, \mbox{\hyperlink{config_8h_aff5e3e5f0579f9bce7aeaeac9d89d33a}{IU}} sz)
\begin{DoxyCompactList}\small\item\em dump memory frm addr...addr+sz \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
e\+Forth implemented in 100\% C/\+C++ for portability and education 



\doxysubsection{Macro Definition Documentation}
\mbox{\Hypertarget{ceforth_8cpp_a1f75956c7e91b6411417071ea93f7bfe}\label{ceforth_8cpp_a1f75956c7e91b6411417071ea93f7bfe}} 
\index{ceforth.cpp@{ceforth.cpp}!BOOL@{BOOL}}
\index{BOOL@{BOOL}!ceforth.cpp@{ceforth.cpp}}
\doxysubsubsection{\texorpdfstring{BOOL}{BOOL}}
{\footnotesize\ttfamily \#define B\+O\+OL(\begin{DoxyParamCaption}\item[{}]{f }\end{DoxyParamCaption})~((f)?-\/1\+:0)}

Forth boolean representation ~\newline
 \mbox{\Hypertarget{ceforth_8cpp_a3fe03e23176f4fe277d1d3b41f3d3d06}\label{ceforth_8cpp_a3fe03e23176f4fe277d1d3b41f3d3d06}} 
\index{ceforth.cpp@{ceforth.cpp}!HERE@{HERE}}
\index{HERE@{HERE}!ceforth.cpp@{ceforth.cpp}}
\doxysubsubsection{\texorpdfstring{HERE}{HERE}}
{\footnotesize\ttfamily \#define H\+E\+RE~(pmem.\+idx)}

current parameter memory index ~\newline
 \mbox{\Hypertarget{ceforth_8cpp_a210af1d04c8870416a556f0e9a5194fd}\label{ceforth_8cpp_a210af1d04c8870416a556f0e9a5194fd}} 
\index{ceforth.cpp@{ceforth.cpp}!LAST@{LAST}}
\index{LAST@{LAST}!ceforth.cpp@{ceforth.cpp}}
\doxysubsubsection{\texorpdfstring{LAST}{LAST}}
{\footnotesize\ttfamily \#define L\+A\+ST~(\mbox{\hyperlink{ceforth_8cpp_aa086a2419b6fa4292fe7a96ade49cfd4}{dict}}\mbox{[}dict.\+idx-\/1\mbox{]})}

last colon word defined ~\newline
 \mbox{\Hypertarget{ceforth_8cpp_a3eb1d48054595d728e295909b0bd07a6}\label{ceforth_8cpp_a3eb1d48054595d728e295909b0bd07a6}} 
\index{ceforth.cpp@{ceforth.cpp}!MEM@{MEM}}
\index{MEM@{MEM}!ceforth.cpp@{ceforth.cpp}}
\doxysubsubsection{\texorpdfstring{MEM}{MEM}}
{\footnotesize\ttfamily \#define M\+EM(\begin{DoxyParamCaption}\item[{}]{a }\end{DoxyParamCaption})~(\mbox{\hyperlink{ceforth_8cpp_aba2779b6f01bb7f61e36d7bc577bb2aa}{M\+E\+M0}} + (\mbox{\hyperlink{config_8h_aff5e3e5f0579f9bce7aeaeac9d89d33a}{IU}})\mbox{\hyperlink{config_8h_a7b3b4f9835caaf6be7bfa7f843bbec05}{U\+I\+NT}}(a))}

pointer to address fetched from pmem ~\newline
 \mbox{\Hypertarget{ceforth_8cpp_a278f9ef19c0a24da568b7bfa81e666f6}\label{ceforth_8cpp_a278f9ef19c0a24da568b7bfa81e666f6}} 
\index{ceforth.cpp@{ceforth.cpp}!IGET@{IGET}}
\index{IGET@{IGET}!ceforth.cpp@{ceforth.cpp}}
\doxysubsubsection{\texorpdfstring{IGET}{IGET}}
{\footnotesize\ttfamily \#define I\+G\+ET(\begin{DoxyParamCaption}\item[{}]{ip }\end{DoxyParamCaption})~($\ast$(\mbox{\hyperlink{config_8h_aff5e3e5f0579f9bce7aeaeac9d89d33a}{IU}}$\ast$)\mbox{\hyperlink{ceforth_8cpp_a3eb1d48054595d728e295909b0bd07a6}{M\+EM}}(ip))}

instruction fetch from pmem+ip offset ~\newline
 \mbox{\Hypertarget{ceforth_8cpp_abc4b981c6dc73973a1fba2c05b54b1bd}\label{ceforth_8cpp_abc4b981c6dc73973a1fba2c05b54b1bd}} 
\index{ceforth.cpp@{ceforth.cpp}!CELL@{CELL}}
\index{CELL@{CELL}!ceforth.cpp@{ceforth.cpp}}
\doxysubsubsection{\texorpdfstring{CELL}{CELL}}
{\footnotesize\ttfamily \#define C\+E\+LL(\begin{DoxyParamCaption}\item[{}]{a }\end{DoxyParamCaption})~($\ast$(\mbox{\hyperlink{config_8h_a57c78d17a8f015df496afc50c9ab973d}{DU}}$\ast$)\&\mbox{\hyperlink{ceforth_8cpp_ad2bf19bcc0873d759b452babdb340575}{pmem}}\mbox{[}a\mbox{]})}

fetch a cell from parameter memory ~\newline
 \mbox{\Hypertarget{ceforth_8cpp_aedb0320e993911a93a9d9c587dea3f00}\label{ceforth_8cpp_aedb0320e993911a93a9d9c587dea3f00}} 
\index{ceforth.cpp@{ceforth.cpp}!SETJMP@{SETJMP}}
\index{SETJMP@{SETJMP}!ceforth.cpp@{ceforth.cpp}}
\doxysubsubsection{\texorpdfstring{SETJMP}{SETJMP}}
{\footnotesize\ttfamily \#define S\+E\+T\+J\+MP(\begin{DoxyParamCaption}\item[{}]{a }\end{DoxyParamCaption})~($\ast$(\mbox{\hyperlink{config_8h_aff5e3e5f0579f9bce7aeaeac9d89d33a}{IU}}$\ast$)\&\mbox{\hyperlink{ceforth_8cpp_ad2bf19bcc0873d759b452babdb340575}{pmem}}\mbox{[}a\mbox{]} = \mbox{\hyperlink{ceforth_8cpp_a3fe03e23176f4fe277d1d3b41f3d3d06}{H\+E\+RE}})}

address offset for branching opcodes ~\newline
 \mbox{\Hypertarget{ceforth_8cpp_a76706a11ce64f9e12be4070f3832c1e6}\label{ceforth_8cpp_a76706a11ce64f9e12be4070f3832c1e6}} 
\index{ceforth.cpp@{ceforth.cpp}!DICT@{DICT}}
\index{DICT@{DICT}!ceforth.cpp@{ceforth.cpp}}
\doxysubsubsection{\texorpdfstring{DICT}{DICT}}
{\footnotesize\ttfamily \#define D\+I\+CT(\begin{DoxyParamCaption}\item[{}]{w }\end{DoxyParamCaption})~(\mbox{\hyperlink{ceforth_8h_a24fba804f04a45a65e1de9174fc1d839}{I\+S\+\_\+\+P\+R\+IM}}(w) ? \mbox{\hyperlink{ceforth_8cpp_a55a769ec05dd5b5b7b6295534541f6bc}{prim}}\mbox{[}w \& $\sim$\mbox{\hyperlink{ceforth_8h_aec92280c39d2b899a51e92addf82ea7e}{E\+X\+T\+\_\+\+F\+L\+AG}}\mbox{]} \+: \mbox{\hyperlink{ceforth_8cpp_aa086a2419b6fa4292fe7a96ade49cfd4}{dict}}\mbox{[}w\mbox{]})}

\mbox{\Hypertarget{ceforth_8cpp_a99cca8c766bbb673859637a1cf1f1150}\label{ceforth_8cpp_a99cca8c766bbb673859637a1cf1f1150}} 
\index{ceforth.cpp@{ceforth.cpp}!DISPATCH@{DISPATCH}}
\index{DISPATCH@{DISPATCH}!ceforth.cpp@{ceforth.cpp}}
\doxysubsubsection{\texorpdfstring{DISPATCH}{DISPATCH}}
{\footnotesize\ttfamily \#define D\+I\+S\+P\+A\+T\+CH(\begin{DoxyParamCaption}\item[{}]{op }\end{DoxyParamCaption})~switch(op)}

\begin{quote}
Forth inner interpreter (handles a colon word) \end{quote}
Note\+:
\begin{DoxyItemize}
\item overhead here in C call/return vs N\+E\+XT threading (in assembly)
\item use of dp (iterative depth control) instead of WP by Dr. Ting speeds up 8\% vs recursive calls but loose the flexibity of Forth
\item use of cached \+\_\+\+N\+XT address speeds up 10\% on A\+MD but 5\% slower on E\+S\+P32 probably due to shallow pipeline
\item computed label runs 15\% faster, but needs long macros (for enum)
\item use local stack speeds up 10\%, but allot 4$\ast$64 bytes extra
\end{DoxyItemize}

T\+O\+DO\+: performance tuning
\begin{DoxyEnumerate}
\item Just-\/in-\/time cache(ip, dp)
\item Co-\/routine 
\end{DoxyEnumerate}\mbox{\Hypertarget{ceforth_8cpp_af65ce469bd4158499d1024818862e4dc}\label{ceforth_8cpp_af65ce469bd4158499d1024818862e4dc}} 
\index{ceforth.cpp@{ceforth.cpp}!CASE@{CASE}}
\index{CASE@{CASE}!ceforth.cpp@{ceforth.cpp}}
\doxysubsubsection{\texorpdfstring{CASE}{CASE}}
{\footnotesize\ttfamily \#define C\+A\+SE(\begin{DoxyParamCaption}\item[{}]{op,  }\item[{}]{g }\end{DoxyParamCaption})~case op \+: \{ g; \} break}

\mbox{\Hypertarget{ceforth_8cpp_a323b79d06bef13e322d167f6bcd1551a}\label{ceforth_8cpp_a323b79d06bef13e322d167f6bcd1551a}} 
\index{ceforth.cpp@{ceforth.cpp}!OTHER@{OTHER}}
\index{OTHER@{OTHER}!ceforth.cpp@{ceforth.cpp}}
\doxysubsubsection{\texorpdfstring{OTHER}{OTHER}}
{\footnotesize\ttfamily \#define O\+T\+H\+ER(\begin{DoxyParamCaption}\item[{}]{g }\end{DoxyParamCaption})~default \+: \{ g; \} break}

\mbox{\Hypertarget{ceforth_8cpp_afe653f1b559a004a35dc3cbeed40a25d}\label{ceforth_8cpp_afe653f1b559a004a35dc3cbeed40a25d}} 
\index{ceforth.cpp@{ceforth.cpp}!UNNEST@{UNNEST}}
\index{UNNEST@{UNNEST}!ceforth.cpp@{ceforth.cpp}}
\doxysubsubsection{\texorpdfstring{UNNEST}{UNNEST}}
{\footnotesize\ttfamily \#define U\+N\+N\+E\+ST(\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})~(\mbox{\hyperlink{ceforth_8cpp_a170318f415c56c413f6f4b7128d5f108}{VM}} = (\mbox{\hyperlink{ceforth_8cpp_afbbad1e6f5dfbd3664246a4a3a623559}{IP}}=\mbox{\hyperlink{config_8h_a7b3b4f9835caaf6be7bfa7f843bbec05}{U\+I\+NT}}(rs.\+pop())) ? \mbox{\hyperlink{ceforth_8cpp_a0f69c35de808703dbcaf85edc29cd4bfa9cfa27b414cab750fb14ec07cdf5cf6a}{H\+O\+LD}} \+: \mbox{\hyperlink{ceforth_8cpp_a0f69c35de808703dbcaf85edc29cd4bfa679ee5320d66c8322e310daeb2ee99b8}{S\+T\+OP}})}

\mbox{\Hypertarget{ceforth_8cpp_a50a5b647d9188740e7087eb7cd1472c7}\label{ceforth_8cpp_a50a5b647d9188740e7087eb7cd1472c7}} 
\index{ceforth.cpp@{ceforth.cpp}!TONAME@{TONAME}}
\index{TONAME@{TONAME}!ceforth.cpp@{ceforth.cpp}}
\doxysubsubsection{\texorpdfstring{TONAME}{TONAME}}
{\footnotesize\ttfamily \#define T\+O\+N\+A\+ME(\begin{DoxyParamCaption}\item[{}]{w }\end{DoxyParamCaption})~(\mbox{\hyperlink{ceforth_8cpp_aa086a2419b6fa4292fe7a96ade49cfd4}{dict}}\mbox{[}w\mbox{]}.pfa -\/ \mbox{\hyperlink{config_8h_a916ffefe1fc74532d08102cca55d8e34}{S\+T\+R\+L\+EN}}(\mbox{\hyperlink{ceforth_8cpp_aa086a2419b6fa4292fe7a96ade49cfd4}{dict}}\mbox{[}w\mbox{]}.name))}



\doxysubsection{Enumeration Type Documentation}
\mbox{\Hypertarget{ceforth_8cpp_a0f69c35de808703dbcaf85edc29cd4bf}\label{ceforth_8cpp_a0f69c35de808703dbcaf85edc29cd4bf}} 
\index{ceforth.cpp@{ceforth.cpp}!vm\_state@{vm\_state}}
\index{vm\_state@{vm\_state}!ceforth.cpp@{ceforth.cpp}}
\doxysubsubsection{\texorpdfstring{vm\_state}{vm\_state}}
{\footnotesize\ttfamily enum \mbox{\hyperlink{ceforth_8cpp_a0f69c35de808703dbcaf85edc29cd4bf}{vm\+\_\+state}}}

\begin{DoxyEnumFields}{Enumerator}
\raisebox{\heightof{T}}[0pt][0pt]{\index{STOP@{STOP}!ceforth.cpp@{ceforth.cpp}}\index{ceforth.cpp@{ceforth.cpp}!STOP@{STOP}}}\mbox{\Hypertarget{ceforth_8cpp_a0f69c35de808703dbcaf85edc29cd4bfa679ee5320d66c8322e310daeb2ee99b8}\label{ceforth_8cpp_a0f69c35de808703dbcaf85edc29cd4bfa679ee5320d66c8322e310daeb2ee99b8}} 
S\+T\+OP&\\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{HOLD@{HOLD}!ceforth.cpp@{ceforth.cpp}}\index{ceforth.cpp@{ceforth.cpp}!HOLD@{HOLD}}}\mbox{\Hypertarget{ceforth_8cpp_a0f69c35de808703dbcaf85edc29cd4bfa9cfa27b414cab750fb14ec07cdf5cf6a}\label{ceforth_8cpp_a0f69c35de808703dbcaf85edc29cd4bfa9cfa27b414cab750fb14ec07cdf5cf6a}} 
H\+O\+LD&\\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{QUERY@{QUERY}!ceforth.cpp@{ceforth.cpp}}\index{ceforth.cpp@{ceforth.cpp}!QUERY@{QUERY}}}\mbox{\Hypertarget{ceforth_8cpp_a0f69c35de808703dbcaf85edc29cd4bfa21043ddfa5289b4cf14cd4e3f5a89b62}\label{ceforth_8cpp_a0f69c35de808703dbcaf85edc29cd4bfa21043ddfa5289b4cf14cd4e3f5a89b62}} 
Q\+U\+E\+RY&\\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{NEST@{NEST}!ceforth.cpp@{ceforth.cpp}}\index{ceforth.cpp@{ceforth.cpp}!NEST@{NEST}}}\mbox{\Hypertarget{ceforth_8cpp_a0f69c35de808703dbcaf85edc29cd4bfa5f0b5e8a99b9441721ea34f14ccc60fe}\label{ceforth_8cpp_a0f69c35de808703dbcaf85edc29cd4bfa5f0b5e8a99b9441721ea34f14ccc60fe}} 
N\+E\+ST&\\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{IO@{IO}!ceforth.cpp@{ceforth.cpp}}\index{ceforth.cpp@{ceforth.cpp}!IO@{IO}}}\mbox{\Hypertarget{ceforth_8cpp_a0f69c35de808703dbcaf85edc29cd4bfaedd9974ef2207e0a03e0717dcb9e2269}\label{ceforth_8cpp_a0f69c35de808703dbcaf85edc29cd4bfaedd9974ef2207e0a03e0717dcb9e2269}} 
IO&\\
\hline

\end{DoxyEnumFields}


\doxysubsection{Function Documentation}
\mbox{\Hypertarget{ceforth_8cpp_a5fdde0871776510df64f500650209b27}\label{ceforth_8cpp_a5fdde0871776510df64f500650209b27}} 
\index{ceforth.cpp@{ceforth.cpp}!PUSH@{PUSH}}
\index{PUSH@{PUSH}!ceforth.cpp@{ceforth.cpp}}
\doxysubsubsection{\texorpdfstring{PUSH()}{PUSH()}}
{\footnotesize\ttfamily void P\+U\+SH (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{config_8h_a57c78d17a8f015df496afc50c9ab973d}{DU}}}]{v }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}

\begin{quote}
inline functions to reduce verbosity \end{quote}
\mbox{\Hypertarget{ceforth_8cpp_ac84ee2b65e9f8a8a435a447462c6d6a0}\label{ceforth_8cpp_ac84ee2b65e9f8a8a435a447462c6d6a0}} 
\index{ceforth.cpp@{ceforth.cpp}!POP@{POP}}
\index{POP@{POP}!ceforth.cpp@{ceforth.cpp}}
\doxysubsubsection{\texorpdfstring{POP()}{POP()}}
{\footnotesize\ttfamily \mbox{\hyperlink{config_8h_a57c78d17a8f015df496afc50c9ab973d}{DU}} P\+OP (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}

\mbox{\Hypertarget{ceforth_8cpp_a9101adddcefa40443edb8cfd578f5fc2}\label{ceforth_8cpp_a9101adddcefa40443edb8cfd578f5fc2}} 
\index{ceforth.cpp@{ceforth.cpp}!find@{find}}
\index{find@{find}!ceforth.cpp@{ceforth.cpp}}
\doxysubsubsection{\texorpdfstring{find()}{find()}}
{\footnotesize\ttfamily \mbox{\hyperlink{config_8h_aff5e3e5f0579f9bce7aeaeac9d89d33a}{IU}} find (\begin{DoxyParamCaption}\item[{const char $\ast$}]{s }\end{DoxyParamCaption})}

\mbox{\Hypertarget{ceforth_8cpp_a2ea8f3d3b90031d767bd8abc9d47daa1}\label{ceforth_8cpp_a2ea8f3d3b90031d767bd8abc9d47daa1}} 
\index{ceforth.cpp@{ceforth.cpp}!colon@{colon}}
\index{colon@{colon}!ceforth.cpp@{ceforth.cpp}}
\doxysubsubsection{\texorpdfstring{colon()}{colon()}}
{\footnotesize\ttfamily void colon (\begin{DoxyParamCaption}\item[{const char $\ast$}]{name }\end{DoxyParamCaption})}

\begin{quote}
current pmem pointer \end{quote}


\begin{quote}
string length, aligned \end{quote}


\begin{quote}
setup raw name field \end{quote}


\begin{quote}
create a local blank word \end{quote}


\begin{quote}
specify a colon (user defined) word \end{quote}


\begin{quote}
capture code field index \end{quote}


\begin{quote}
deep copy \mbox{\hyperlink{structCode}{Code}} struct into dictionary \end{quote}
\mbox{\Hypertarget{ceforth_8cpp_aed1e848eb616f3919d0a9bb06453695e}\label{ceforth_8cpp_aed1e848eb616f3919d0a9bb06453695e}} 
\index{ceforth.cpp@{ceforth.cpp}!add\_str@{add\_str}}
\index{add\_str@{add\_str}!ceforth.cpp@{ceforth.cpp}}
\doxysubsubsection{\texorpdfstring{add\_str()}{add\_str()}}
{\footnotesize\ttfamily int add\+\_\+str (\begin{DoxyParamCaption}\item[{const char $\ast$}]{s }\end{DoxyParamCaption})}

$<$ add a string to pmem


\begin{DoxyItemize}
\item add string terminated with zero
\end{DoxyItemize}\mbox{\Hypertarget{ceforth_8cpp_a6501518596206111ab40166b28ac6ae1}\label{ceforth_8cpp_a6501518596206111ab40166b28ac6ae1}} 
\index{ceforth.cpp@{ceforth.cpp}!add\_w@{add\_w}}
\index{add\_w@{add\_w}!ceforth.cpp@{ceforth.cpp}}
\doxysubsubsection{\texorpdfstring{add\_w()}{add\_w()}}
{\footnotesize\ttfamily void add\+\_\+w (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{config_8h_aff5e3e5f0579f9bce7aeaeac9d89d33a}{IU}}}]{w }\end{DoxyParamCaption})}

$<$ add a word index into pmem


\begin{DoxyItemize}
\item ref to primitive or dictionary
\item is primitive?
\item get primitive/built-\/in token
\item colon word?
\item pfa with colon word flag
\item XT offset of built-\/in
\end{DoxyItemize}\mbox{\Hypertarget{ceforth_8cpp_a7775cab16db630b8457bdb457a8644f4}\label{ceforth_8cpp_a7775cab16db630b8457bdb457a8644f4}} 
\index{ceforth.cpp@{ceforth.cpp}!add\_var@{add\_var}}
\index{add\_var@{add\_var}!ceforth.cpp@{ceforth.cpp}}
\doxysubsubsection{\texorpdfstring{add\_var()}{add\_var()}}
{\footnotesize\ttfamily void add\+\_\+var (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{config_8h_aff5e3e5f0579f9bce7aeaeac9d89d33a}{IU}}}]{op,  }\item[{\mbox{\hyperlink{config_8h_a57c78d17a8f015df496afc50c9ab973d}{DU}}}]{v = {\ttfamily \mbox{\hyperlink{config_8h_ab09a231138adc0fb73bfb9ba7144b797}{D\+U0}}} }\end{DoxyParamCaption})}

$<$ add a literal/varirable header


\begin{DoxyItemize}
\item V\+AR or V\+B\+R\+AN
\item pad offset field
\item data alignment (W\+A\+SM 4, other 2)
\item default variable = 0
\end{DoxyItemize}\mbox{\Hypertarget{ceforth_8cpp_aaa0fe6aede838886c3897f55c3d28ddd}\label{ceforth_8cpp_aaa0fe6aede838886c3897f55c3d28ddd}} 
\index{ceforth.cpp@{ceforth.cpp}!def\_word@{def\_word}}
\index{def\_word@{def\_word}!ceforth.cpp@{ceforth.cpp}}
\doxysubsubsection{\texorpdfstring{def\_word()}{def\_word()}}
{\footnotesize\ttfamily int def\+\_\+word (\begin{DoxyParamCaption}\item[{const char $\ast$}]{name }\end{DoxyParamCaption})}

$<$ display if redefined


\begin{DoxyItemize}
\item missing name?
\item word redefined?
\item create a colon word
\item created OK
\end{DoxyItemize}\mbox{\Hypertarget{ceforth_8cpp_af629538f3b0c84bcc653fb92698c4f05}\label{ceforth_8cpp_af629538f3b0c84bcc653fb92698c4f05}} 
\index{ceforth.cpp@{ceforth.cpp}!word@{word}}
\index{word@{word}!ceforth.cpp@{ceforth.cpp}}
\doxysubsubsection{\texorpdfstring{word()}{word()}}
{\footnotesize\ttfamily char$\ast$ word (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}

$<$ get next idiom

$<$ tmp string holder


\begin{DoxyItemize}
\item input buffer exhausted?
\end{DoxyItemize}\mbox{\Hypertarget{ceforth_8cpp_a912b572f7c21344049788c2faebd9f82}\label{ceforth_8cpp_a912b572f7c21344049788c2faebd9f82}} 
\index{ceforth.cpp@{ceforth.cpp}!s\_quote@{s\_quote}}
\index{s\_quote@{s\_quote}!ceforth.cpp@{ceforth.cpp}}
\doxysubsubsection{\texorpdfstring{s\_quote()}{s\_quote()}}
{\footnotesize\ttfamily void s\+\_\+quote (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{ceforth_8h_af99290ebc7dc90e2d53b08b8445f90cf}{prim\+\_\+op}}}]{op }\end{DoxyParamCaption})}

\begin{quote}
string skip first blank \end{quote}


\begin{quote}
dostr, (+parameter field) \end{quote}


\begin{quote}
byte0, byte1, byte2, ..., byteN \end{quote}


\begin{quote}
use P\+AD ad T\+E\+MP storage \end{quote}


\begin{quote}
keep current memory addr \end{quote}


\begin{quote}
write string to P\+AD \end{quote}


\begin{quote}
push string address \end{quote}


\begin{quote}
push string length \end{quote}


\begin{quote}
restore memory addr \end{quote}
\mbox{\Hypertarget{ceforth_8cpp_ad846502b6abc77557b95ffb1d08699cc}\label{ceforth_8cpp_ad846502b6abc77557b95ffb1d08699cc}} 
\index{ceforth.cpp@{ceforth.cpp}!nest@{nest}}
\index{nest@{nest}!ceforth.cpp@{ceforth.cpp}}
\doxysubsubsection{\texorpdfstring{nest()}{nest()}}
{\footnotesize\ttfamily void nest (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}


\begin{DoxyItemize}
\item activate VM
\end{DoxyItemize}

$<$ fetched opcode, hopefully in register


\begin{DoxyItemize}
\item opcode dispatcher
\end{DoxyItemize}

\begin{quote}
loop done? \end{quote}



\begin{DoxyItemize}
\item no, loop back
\item yes, loop done!
\item pop off loop counter
\item next instr.
\end{DoxyItemize}

\begin{quote}
loop done? \end{quote}



\begin{DoxyItemize}
\item no, loop back
\item yes, done
\item pop off counters
\item next instr.
\item 32-\/bit data align (W\+A\+SM only)
\end{DoxyItemize}

\begin{quote}
from hot cache, hopefully \end{quote}



\begin{DoxyItemize}
\item hop over the stored value
\end{DoxyItemize}

\begin{quote}
get var addr \end{quote}


$<$ get string pointer

.\char`\"{} ...\char`\"{}

$<$ get string pointer


\begin{DoxyItemize}
\item send to output console
\item unconditional branch
\item conditional branch
\item put param addr on tos
\item jump target of does$>$ if given
\end{DoxyItemize}

$<$ memory pointer to pfa


\begin{DoxyItemize}
\item encode current IP, and bail
\item setup F\+OR..N\+E\+XT call frame
\item setup DO..L\+O\+OP call frame
\item fetch single keypress
\item colon word?
\item setup call frame
\item IP = word.\+pfa
\end{DoxyItemize}

\begin{quote}
execute built-\/in word \end{quote}
\mbox{\Hypertarget{ceforth_8cpp_a724b39fd304fec7d17cfd9af5171683f}\label{ceforth_8cpp_a724b39fd304fec7d17cfd9af5171683f}} 
\index{ceforth.cpp@{ceforth.cpp}!CALL@{CALL}}
\index{CALL@{CALL}!ceforth.cpp@{ceforth.cpp}}
\doxysubsubsection{\texorpdfstring{CALL()}{CALL()}}
{\footnotesize\ttfamily void C\+A\+LL (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{config_8h_aff5e3e5f0579f9bce7aeaeac9d89d33a}{IU}}}]{w }\end{DoxyParamCaption})}

\begin{quote}
C\+A\+LL -\/ inner-\/interpreter proxy (inline macro does not run faster) \end{quote}
colon word

setup task context

built-\/in word\mbox{\Hypertarget{ceforth_8cpp_a3b21cefa3dc7cbff6e06fedf876f0f3a}\label{ceforth_8cpp_a3b21cefa3dc7cbff6e06fedf876f0f3a}} 
\index{ceforth.cpp@{ceforth.cpp}!load@{load}}
\index{load@{load}!ceforth.cpp@{ceforth.cpp}}
\doxysubsubsection{\texorpdfstring{load()}{load()}}
{\footnotesize\ttfamily void load (\begin{DoxyParamCaption}\item[{const char $\ast$}]{fn }\end{DoxyParamCaption})}

\begin{quote}
Forth script loader \end{quote}

\begin{DoxyItemize}
\item increment depth counter
\item save context
\item +recursive
\item include file
\item restore context
\item decrement depth counter
\end{DoxyItemize}\mbox{\Hypertarget{ceforth_8cpp_af778fbbfe8f4407700d6f0b6a5c3fa09}\label{ceforth_8cpp_af778fbbfe8f4407700d6f0b6a5c3fa09}} 
\index{ceforth.cpp@{ceforth.cpp}!dict\_validate@{dict\_validate}}
\index{dict\_validate@{dict\_validate}!ceforth.cpp@{ceforth.cpp}}
\doxysubsubsection{\texorpdfstring{dict\_validate()}{dict\_validate()}}
{\footnotesize\ttfamily void dict\+\_\+validate (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}

collect \mbox{\hyperlink{structCode_a7b5d258f3dc3b41f55432cd37a9d9348}{Code\+::\+X\+T0}} i.\+e. xt base pointer

check xtoff range\mbox{\Hypertarget{ceforth_8cpp_af4d8edffd9e7bdec7cabac4227a9a4f1}\label{ceforth_8cpp_af4d8edffd9e7bdec7cabac4227a9a4f1}} 
\index{ceforth.cpp@{ceforth.cpp}!parse\_number@{parse\_number}}
\index{parse\_number@{parse\_number}!ceforth.cpp@{ceforth.cpp}}
\doxysubsubsection{\texorpdfstring{parse\_number()}{parse\_number()}}
{\footnotesize\ttfamily \mbox{\hyperlink{config_8h_a57c78d17a8f015df496afc50c9ab973d}{DU}} parse\+\_\+number (\begin{DoxyParamCaption}\item[{const char $\ast$}]{idiom,  }\item[{int $\ast$}]{err }\end{DoxyParamCaption})}

====================================================================

\begin{quote}
Forth\+VM -\/ Outer interpreter \end{quote}
\begin{quote}
base override \end{quote}
\mbox{\Hypertarget{ceforth_8cpp_a1238c49b581d1d9fc9908f87f645a136}\label{ceforth_8cpp_a1238c49b581d1d9fc9908f87f645a136}} 
\index{ceforth.cpp@{ceforth.cpp}!forth\_core@{forth\_core}}
\index{forth\_core@{forth\_core}!ceforth.cpp@{ceforth.cpp}}
\doxysubsubsection{\texorpdfstring{forth\_core()}{forth\_core()}}
{\footnotesize\ttfamily void forth\+\_\+core (\begin{DoxyParamCaption}\item[{const char $\ast$}]{idiom }\end{DoxyParamCaption})}

\begin{quote}
aka Q\+U\+E\+RY \end{quote}


\begin{quote}

\begin{DoxyItemize}
\item get token by searching through dict 
\end{DoxyItemize}\end{quote}


\begin{quote}

\begin{DoxyItemize}
\item word found? 
\end{DoxyItemize}\end{quote}



\begin{DoxyItemize}
\item in compile mode?
\item add to colon word
\item execute forth word
\item not number
\end{DoxyItemize}

\begin{quote}
display error prompt \end{quote}


\begin{quote}
reset to interpreter mode \end{quote}


\begin{quote}
skip the entire input buffer \end{quote}



\begin{DoxyItemize}
\item a number in compile mode?
\end{DoxyItemize}

\begin{quote}
add to current word \end{quote}


\begin{quote}
or, add value onto data stack \end{quote}
\mbox{\Hypertarget{ceforth_8cpp_a7f66d1cf6a56ed50c9abd5331ed2073e}\label{ceforth_8cpp_a7f66d1cf6a56ed50c9abd5331ed2073e}} 
\index{ceforth.cpp@{ceforth.cpp}!forth\_init@{forth\_init}}
\index{forth\_init@{forth\_init}!ceforth.cpp@{ceforth.cpp}}
\doxysubsubsection{\texorpdfstring{forth\_init()}{forth\_init()}}
{\footnotesize\ttfamily void forth\+\_\+init (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}

====================================================================

Forth VM external command processor \begin{quote}
check dictionary initilized \end{quote}


$<$ set pointer to base

$<$ allocate space for base

$<$ set pointer to dfmt


\begin{DoxyItemize}
\item padding user area
\end{DoxyItemize}

$<$ compile dictionary

$<$ collect X\+T0, and check xtoff range\mbox{\Hypertarget{ceforth_8cpp_abe1f9e941c1425c4edb59d5e2269ae59}\label{ceforth_8cpp_abe1f9e941c1425c4edb59d5e2269ae59}} 
\index{ceforth.cpp@{ceforth.cpp}!forth\_vm@{forth\_vm}}
\index{forth\_vm@{forth\_vm}!ceforth.cpp@{ceforth.cpp}}
\doxysubsubsection{\texorpdfstring{forth\_vm()}{forth\_vm()}}
{\footnotesize\ttfamily int forth\+\_\+vm (\begin{DoxyParamCaption}\item[{const char $\ast$}]{line,  }\item[{void($\ast$)(int, const char $\ast$)}]{hook }\end{DoxyParamCaption})}


\begin{DoxyItemize}
\item time slice up
\item real-\/time support, 10ms = 100Hz
\end{DoxyItemize}

\begin{quote}
check timing \end{quote}


$<$ serial output hook up

$<$ check VM resume status


\begin{DoxyItemize}
\item restore context
\end{DoxyItemize}

\begin{quote}
refresh buffer if not resuming \end{quote}



\begin{DoxyItemize}
\item parse a word
\item resume task
\item send to Forth core
\end{DoxyItemize}

\begin{quote}
multi-\/threading support \end{quote}



\begin{DoxyItemize}
\item yield to other tasks
\item save context
\item optionally display stack contents
\end{DoxyItemize}\mbox{\Hypertarget{ceforth_8cpp_a05e51dee76eecef6d8eb2a7b7f99466b}\label{ceforth_8cpp_a05e51dee76eecef6d8eb2a7b7f99466b}} 
\index{ceforth.cpp@{ceforth.cpp}!outer@{outer}}
\index{outer@{outer}!ceforth.cpp@{ceforth.cpp}}
\doxysubsubsection{\texorpdfstring{outer()}{outer()}}
{\footnotesize\ttfamily void outer (\begin{DoxyParamCaption}\item[{istream \&}]{in }\end{DoxyParamCaption})}



load external Forth script 

Forth outer loop 
\begin{DoxyItemize}
\item read line-\/by-\/line
\end{DoxyItemize}\mbox{\Hypertarget{ceforth_8cpp_adacbe0175a79dff748855d8c9839f82b}\label{ceforth_8cpp_adacbe0175a79dff748855d8c9839f82b}} 
\index{ceforth.cpp@{ceforth.cpp}!main@{main}}
\index{main@{main}!ceforth.cpp@{ceforth.cpp}}
\doxysubsubsection{\texorpdfstring{main()}{main()}}
{\footnotesize\ttfamily int main (\begin{DoxyParamCaption}\item[{int}]{ac,  }\item[{char $\ast$}]{av\mbox{[}$\,$\mbox{]} }\end{DoxyParamCaption})}

\mbox{\Hypertarget{ceforth_8cpp_a1edeac2b9a9f3903fcf20538b18e9ee4}\label{ceforth_8cpp_a1edeac2b9a9f3903fcf20538b18e9ee4}} 
\index{ceforth.cpp@{ceforth.cpp}!fin\_setup@{fin\_setup}}
\index{fin\_setup@{fin\_setup}!ceforth.cpp@{ceforth.cpp}}
\doxysubsubsection{\texorpdfstring{fin\_setup()}{fin\_setup()}}
{\footnotesize\ttfamily void fin\+\_\+setup (\begin{DoxyParamCaption}\item[{const char $\ast$}]{line }\end{DoxyParamCaption})}


\begin{DoxyItemize}
\item clean output buffer
\item clear input stream error bit if any
\item reload user command into input stream
\end{DoxyItemize}\mbox{\Hypertarget{ceforth_8cpp_abd89dd3df33c460274765e882a8f156c}\label{ceforth_8cpp_abd89dd3df33c460274765e882a8f156c}} 
\index{ceforth.cpp@{ceforth.cpp}!fout\_setup@{fout\_setup}}
\index{fout\_setup@{fout\_setup}!ceforth.cpp@{ceforth.cpp}}
\doxysubsubsection{\texorpdfstring{fout\_setup()}{fout\_setup()}}
{\footnotesize\ttfamily void fout\+\_\+setup (\begin{DoxyParamCaption}\item[{void($\ast$)(int, const char $\ast$)}]{hook }\end{DoxyParamCaption})}

$<$ serial output hook up\mbox{\Hypertarget{ceforth_8cpp_a6f241997f1fbe0bb5ddde7d646f96a4c}\label{ceforth_8cpp_a6f241997f1fbe0bb5ddde7d646f96a4c}} 
\index{ceforth.cpp@{ceforth.cpp}!scan@{scan}}
\index{scan@{scan}!ceforth.cpp@{ceforth.cpp}}
\doxysubsubsection{\texorpdfstring{scan()}{scan()}}
{\footnotesize\ttfamily char$\ast$ scan (\begin{DoxyParamCaption}\item[{char}]{c }\end{DoxyParamCaption})}



scan input stream for a given char 

\mbox{\Hypertarget{ceforth_8cpp_a7b6f338854360679dc3bb527a89e43fb}\label{ceforth_8cpp_a7b6f338854360679dc3bb527a89e43fb}} 
\index{ceforth.cpp@{ceforth.cpp}!fetch@{fetch}}
\index{fetch@{fetch}!ceforth.cpp@{ceforth.cpp}}
\doxysubsubsection{\texorpdfstring{fetch()}{fetch()}}
{\footnotesize\ttfamily int fetch (\begin{DoxyParamCaption}\item[{string \&}]{idiom }\end{DoxyParamCaption})}



read input stream into string 

\mbox{\Hypertarget{ceforth_8cpp_a59a029cd22163e0e580d06b4bc9b93e3}\label{ceforth_8cpp_a59a029cd22163e0e580d06b4bc9b93e3}} 
\index{ceforth.cpp@{ceforth.cpp}!spaces@{spaces}}
\index{spaces@{spaces}!ceforth.cpp@{ceforth.cpp}}
\doxysubsubsection{\texorpdfstring{spaces()}{spaces()}}
{\footnotesize\ttfamily void spaces (\begin{DoxyParamCaption}\item[{int}]{n }\end{DoxyParamCaption})}



show spaces 

\mbox{\Hypertarget{ceforth_8cpp_a8ce34dd2181a4dc960b6cb73061e2891}\label{ceforth_8cpp_a8ce34dd2181a4dc960b6cb73061e2891}} 
\index{ceforth.cpp@{ceforth.cpp}!put@{put}}
\index{put@{put}!ceforth.cpp@{ceforth.cpp}}
\doxysubsubsection{\texorpdfstring{put()}{put()}}
{\footnotesize\ttfamily void put (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{ceforth_8h_a30d7a36b04fcbc60a9c39e64ac64b27d}{io\+\_\+op}}}]{op,  }\item[{\mbox{\hyperlink{config_8h_a57c78d17a8f015df496afc50c9ab973d}{DU}}}]{v,  }\item[{\mbox{\hyperlink{config_8h_a57c78d17a8f015df496afc50c9ab973d}{DU}}}]{v2 }\end{DoxyParamCaption})}



print literals 

\mbox{\Hypertarget{ceforth_8cpp_a1edbf4fc6ff6a98a4319552fa601dc56}\label{ceforth_8cpp_a1edbf4fc6ff6a98a4319552fa601dc56}} 
\index{ceforth.cpp@{ceforth.cpp}!pstr@{pstr}}
\index{pstr@{pstr}!ceforth.cpp@{ceforth.cpp}}
\doxysubsubsection{\texorpdfstring{pstr()}{pstr()}}
{\footnotesize\ttfamily void pstr (\begin{DoxyParamCaption}\item[{const char $\ast$}]{str,  }\item[{\mbox{\hyperlink{ceforth_8h_a30d7a36b04fcbc60a9c39e64ac64b27d}{io\+\_\+op}}}]{op = {\ttfamily \mbox{\hyperlink{ceforth_8h_a30d7a36b04fcbc60a9c39e64ac64b27daf603e0d046225e81459ffe6d8ee5ba6b}{BL}}} }\end{DoxyParamCaption})}

print string \mbox{\Hypertarget{ceforth_8cpp_a0a04f8d7424b20a976b85a0757b07d5e}\label{ceforth_8cpp_a0a04f8d7424b20a976b85a0757b07d5e}} 
\index{ceforth.cpp@{ceforth.cpp}!pfa2didx@{pfa2didx}}
\index{pfa2didx@{pfa2didx}!ceforth.cpp@{ceforth.cpp}}
\doxysubsubsection{\texorpdfstring{pfa2didx()}{pfa2didx()}}
{\footnotesize\ttfamily int pfa2didx (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{config_8h_aff5e3e5f0579f9bce7aeaeac9d89d33a}{IU}}}]{ix }\end{DoxyParamCaption})}

\begin{quote}
convert pfa to dictionary entry index \end{quote}
\begin{quote}
reverse lookup \end{quote}


\begin{quote}
primitives \end{quote}


\begin{quote}
pfa (mask colon word) \end{quote}



\begin{DoxyItemize}
\item not found
\end{DoxyItemize}\mbox{\Hypertarget{ceforth_8cpp_ac825b190b7185ebb634231d8edfdafcc}\label{ceforth_8cpp_ac825b190b7185ebb634231d8edfdafcc}} 
\index{ceforth.cpp@{ceforth.cpp}!pfa2allot@{pfa2allot}}
\index{pfa2allot@{pfa2allot}!ceforth.cpp@{ceforth.cpp}}
\doxysubsubsection{\texorpdfstring{pfa2allot()}{pfa2allot()}}
{\footnotesize\ttfamily int pfa2allot (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{config_8h_aff5e3e5f0579f9bce7aeaeac9d89d33a}{IU}}}]{pfa }\end{DoxyParamCaption})}

\begin{quote}
calculate number of variables by given pfa \end{quote}
$<$ fetch opcode

$<$ index to this word

\begin{quote}
get parameter field \end{quote}


$<$ calc bytes allot\mbox{\Hypertarget{ceforth_8cpp_ad98562c5319efcd96d89f375ed173507}\label{ceforth_8cpp_ad98562c5319efcd96d89f375ed173507}} 
\index{ceforth.cpp@{ceforth.cpp}!to\_s@{to\_s}}
\index{to\_s@{to\_s}!ceforth.cpp@{ceforth.cpp}}
\doxysubsubsection{\texorpdfstring{to\_s()}{to\_s()}}
{\footnotesize\ttfamily void to\+\_\+s (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{config_8h_aff5e3e5f0579f9bce7aeaeac9d89d33a}{IU}}}]{w,  }\item[{\mbox{\hyperlink{config_8h_aa63ef7b996d5487ce35a5a66601f3e73}{U8}} $\ast$}]{ip }\end{DoxyParamCaption})}

\begin{quote}
display opcode and literal \end{quote}
\begin{quote}
addr \end{quote}


\begin{quote}
word ref \end{quote}


\begin{quote}
calculate next ip \end{quote}


no break, fall through

\begin{quote}
display jmp target \end{quote}


\begin{quote}
restore output format settings \end{quote}
\mbox{\Hypertarget{ceforth_8cpp_ac7375936d290f4dd3ded50a68694551e}\label{ceforth_8cpp_ac7375936d290f4dd3ded50a68694551e}} 
\index{ceforth.cpp@{ceforth.cpp}!see@{see}}
\index{see@{see}!ceforth.cpp@{ceforth.cpp}}
\doxysubsubsection{\texorpdfstring{see()}{see()}}
{\footnotesize\ttfamily void see (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{config_8h_aff5e3e5f0579f9bce7aeaeac9d89d33a}{IU}}}]{pfa }\end{DoxyParamCaption})}



disassemble user defined word 

\begin{quote}
Forth disassembler \end{quote}
\begin{quote}
fetch word index by pfa \end{quote}


\begin{quote}
loop guard \end{quote}



\begin{DoxyItemize}
\item indent
\item display opcode
\item end of word
\end{DoxyItemize}

\begin{quote}
advance ip (next opcode) \end{quote}


\begin{quote}
extra bytes to skip \end{quote}


\begin{quote}
skip if no jmp target \end{quote}
\mbox{\Hypertarget{ceforth_8cpp_a8c226ea3e83d7102f33d1575b060f511}\label{ceforth_8cpp_a8c226ea3e83d7102f33d1575b060f511}} 
\index{ceforth.cpp@{ceforth.cpp}!words@{words}}
\index{words@{words}!ceforth.cpp@{ceforth.cpp}}
\doxysubsubsection{\texorpdfstring{words()}{words()}}
{\footnotesize\ttfamily void words (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



list dictionary words 

\begin{quote}
display built-\/in and user defined words in dictionary \end{quote}
\mbox{\Hypertarget{ceforth_8cpp_a582bfd1eea6baf2a28d214ff77bc193c}\label{ceforth_8cpp_a582bfd1eea6baf2a28d214ff77bc193c}} 
\index{ceforth.cpp@{ceforth.cpp}!ss\_dump@{ss\_dump}}
\index{ss\_dump@{ss\_dump}!ceforth.cpp@{ceforth.cpp}}
\doxysubsubsection{\texorpdfstring{ss\_dump()}{ss\_dump()}}
{\footnotesize\ttfamily void ss\+\_\+dump (\begin{DoxyParamCaption}\item[{bool}]{forced }\end{DoxyParamCaption})}



show data stack content 

\begin{quote}
show data stack content \end{quote}

\begin{DoxyItemize}
\item skip when including file
\end{DoxyItemize}

$<$ static buffer

$<$ display v by radix\mbox{\Hypertarget{ceforth_8cpp_a00606e924aae9ae9ad50a618443a7847}\label{ceforth_8cpp_a00606e924aae9ae9ad50a618443a7847}} 
\index{ceforth.cpp@{ceforth.cpp}!mem\_dump@{mem\_dump}}
\index{mem\_dump@{mem\_dump}!ceforth.cpp@{ceforth.cpp}}
\doxysubsubsection{\texorpdfstring{mem\_dump()}{mem\_dump()}}
{\footnotesize\ttfamily void mem\+\_\+dump (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{config_8h_a696390429f2f3b644bde8d0322a24124}{U32}}}]{p0,  }\item[{\mbox{\hyperlink{config_8h_aff5e3e5f0579f9bce7aeaeac9d89d33a}{IU}}}]{sz }\end{DoxyParamCaption})}



dump memory frm addr...addr+sz 

\begin{quote}
dump memory content range from \mbox{[}p0, p0+sz) \end{quote}


\doxysubsection{Variable Documentation}
\mbox{\Hypertarget{ceforth_8cpp_a624ee54d8d2274faa869f5908ce720a5}\label{ceforth_8cpp_a624ee54d8d2274faa869f5908ce720a5}} 
\index{ceforth.cpp@{ceforth.cpp}!rs@{rs}}
\index{rs@{rs}!ceforth.cpp@{ceforth.cpp}}
\doxysubsubsection{\texorpdfstring{rs}{rs}}
{\footnotesize\ttfamily \mbox{\hyperlink{structList}{List}}$<$\mbox{\hyperlink{config_8h_a57c78d17a8f015df496afc50c9ab973d}{DU}}, \mbox{\hyperlink{config_8h_a5f69a406901fcf08ab5615294d7f334a}{E4\+\_\+\+R\+S\+\_\+\+SZ}}$>$ rs}



return stack 

====================================================================

\begin{quote}
Global memory blocks \end{quote}


Note\+: 1.\+By separating pmem from dictionary,
\begin{DoxyItemize}
\item it makes dictionary uniform size which eliminates the need for link field
\item however, it requires array size tuning manually 2.\+Using 16-\/bit xt offset in parameter field (instead of full 32 or 64 bits),
\item it unified xt/pfa parameter storage and use the L\+SB for id flag
\item that compacts memory usage while avoiding the double lookup of
\item token threaded indexing.
\item However, it limits function pointer spread within range of 64KB 3.\+For ease of byte counting, U8$\ast$ is used for pmem instead of U16$\ast$.
\item this makes IP increment by 2 instead of word size.
\item If needed, it can be readjusted.
\end{DoxyItemize}

\begin{quote}
Dictionary structure (N=E4\+\_\+\+D\+I\+C\+T\+\_\+\+SZ in \mbox{\hyperlink{config_8h}{config.\+h}}) \end{quote}
dict\mbox{[}0\mbox{]}.xt -\/-\/-\/-\/-\/-\/---$>$ pointer to build-\/in word lambda\mbox{[}0\mbox{]} dict\mbox{[}1\mbox{]}.xt -\/-\/-\/-\/-\/-\/---$>$ pointer to built-\/in word lambda\mbox{[}1\mbox{]} ... dict\mbox{[}N-\/1\mbox{]}.xt -\/-\/-\/-\/---$>$ pointer to last built-\/in word lambda\mbox{[}N-\/1\mbox{]}

\begin{quote}
Parameter memory structure (memory block=E4\+\_\+\+P\+M\+E\+M\+\_\+\+SZ in \mbox{\hyperlink{config_8h}{config.\+h}}) \end{quote}
dict\mbox{[}N\mbox{]}.xt -\/---+ user defined colon word) dict\mbox{[}N+1\mbox{]}.xt-\/-\/-\/---+ $\vert$ $\vert$ +--M\+E\+M0 v v +-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/---+-\/-\/-\/-\/-\/---+-\/-\/-\/-\/-\/---+-\/-\/---+-\/-\/-\/---+-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/---+-\/-\/--- $\vert$ str nameN \textbackslash{}0 $\vert$ parm1 $\vert$ parm2 $\vert$ ... $\vert$ ffff $\vert$ str name\+N+1 \textbackslash{}0 $\vert$ ... +-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/---+-\/-\/-\/-\/-\/---+-\/-\/-\/-\/-\/---+-\/-\/---+-\/-\/-\/---+-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/---+-\/-\/--- $^\wedge$ $^\wedge$ $^\wedge$ $^\wedge$ $^\wedge$ $^\wedge$ $\vert$ strlen+1 $\vert$ 2-\/byte $\vert$ 2-\/byte $\vert$ $\vert$ $\vert$ +-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/---+-\/-\/-\/-\/-\/---+-\/-\/-\/-\/-\/---+-\/-\/---+-\/-\/-\/---+-\/--- 2-\/byte aligned

\begin{quote}
Parameter structure -\/ 16-\/bit aligned (use M\+SB for colon/primitive word flag) \end{quote}

\begin{DoxyItemize}
\item primitive word 16-\/bit xt offset with M\+SB set to 1, where opcode $<$ M\+A\+X\+\_\+\+OP +-\/+-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/---+ $\vert$1$\vert$ opcode $\vert$ call exec\+\_\+prim(opcode) +-\/+-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/---+
\item colon word (user defined) 16-\/bit pmem offset with M\+SB set to 1, where dict.\+pfa $>$= M\+A\+X\+\_\+\+OP +-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/---+-\/+ $\vert$1$\vert$ dict.\+pfa $\vert$ IP = dict.\+pfa +-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/---+-\/+
\item built-\/in word 16-\/bit xt offset with M\+SB set to 0 (1 less mem lookup for xt) +-\/+-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/---+ $\vert$0$\vert$ dict.\+xtoff() $\vert$ call (X\+T0 + $\ast$\+IP)() to execute +-\/+-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/---+ 
\end{DoxyItemize}\mbox{\Hypertarget{ceforth_8cpp_a7dca0eae5111fa9214a2e2598f5a96b0}\label{ceforth_8cpp_a7dca0eae5111fa9214a2e2598f5a96b0}} 
\index{ceforth.cpp@{ceforth.cpp}!ss@{ss}}
\index{ss@{ss}!ceforth.cpp@{ceforth.cpp}}
\doxysubsubsection{\texorpdfstring{ss}{ss}}
{\footnotesize\ttfamily \mbox{\hyperlink{structList}{List}}$<$\mbox{\hyperlink{config_8h_a57c78d17a8f015df496afc50c9ab973d}{DU}}, \mbox{\hyperlink{config_8h_af9fc7bdce59a3dac7fa463f733c888cf}{E4\+\_\+\+S\+S\+\_\+\+SZ}}$>$ ss}



parameter stack 

\mbox{\Hypertarget{ceforth_8cpp_aa086a2419b6fa4292fe7a96ade49cfd4}\label{ceforth_8cpp_aa086a2419b6fa4292fe7a96ade49cfd4}} 
\index{ceforth.cpp@{ceforth.cpp}!dict@{dict}}
\index{dict@{dict}!ceforth.cpp@{ceforth.cpp}}
\doxysubsubsection{\texorpdfstring{dict}{dict}}
{\footnotesize\ttfamily \mbox{\hyperlink{structList}{List}}$<$\mbox{\hyperlink{structCode}{Code}}, \mbox{\hyperlink{config_8h_a3663378c5ef858dd03bc28732c610758}{E4\+\_\+\+D\+I\+C\+T\+\_\+\+SZ}}$>$ dict}



dictionary 

\mbox{\Hypertarget{ceforth_8cpp_ad2bf19bcc0873d759b452babdb340575}\label{ceforth_8cpp_ad2bf19bcc0873d759b452babdb340575}} 
\index{ceforth.cpp@{ceforth.cpp}!pmem@{pmem}}
\index{pmem@{pmem}!ceforth.cpp@{ceforth.cpp}}
\doxysubsubsection{\texorpdfstring{pmem}{pmem}}
{\footnotesize\ttfamily \mbox{\hyperlink{structList}{List}}$<$\mbox{\hyperlink{config_8h_aa63ef7b996d5487ce35a5a66601f3e73}{U8}}, \mbox{\hyperlink{config_8h_a0a0ff68a63bb8a53d930d405fe8624f8}{E4\+\_\+\+P\+M\+E\+M\+\_\+\+SZ}}$>$ pmem}



parameter memory (for colon definitions) 

\mbox{\Hypertarget{ceforth_8cpp_aba2779b6f01bb7f61e36d7bc577bb2aa}\label{ceforth_8cpp_aba2779b6f01bb7f61e36d7bc577bb2aa}} 
\index{ceforth.cpp@{ceforth.cpp}!MEM0@{MEM0}}
\index{MEM0@{MEM0}!ceforth.cpp@{ceforth.cpp}}
\doxysubsubsection{\texorpdfstring{MEM0}{MEM0}}
{\footnotesize\ttfamily \mbox{\hyperlink{config_8h_aa63ef7b996d5487ce35a5a66601f3e73}{U8}}$\ast$ M\+E\+M0 = \&\mbox{\hyperlink{ceforth_8cpp_ad2bf19bcc0873d759b452babdb340575}{pmem}}\mbox{[}0\mbox{]}}

base of parameter memory block \mbox{\Hypertarget{ceforth_8cpp_a55a769ec05dd5b5b7b6295534541f6bc}\label{ceforth_8cpp_a55a769ec05dd5b5b7b6295534541f6bc}} 
\index{ceforth.cpp@{ceforth.cpp}!prim@{prim}}
\index{prim@{prim}!ceforth.cpp@{ceforth.cpp}}
\doxysubsubsection{\texorpdfstring{prim}{prim}}
{\footnotesize\ttfamily \mbox{\hyperlink{structCode}{Code}} prim\mbox{[}$\,$\mbox{]}}

{\bfseries Initial value\+:}
\begin{DoxyCode}{0}
\DoxyCodeLine{= \{}
\DoxyCodeLine{    \mbox{\hyperlink{structCode}{Code}}(\textcolor{stringliteral}{";"},   \mbox{\hyperlink{ceforth_8h_af99290ebc7dc90e2d53b08b8445f90cfa7a10b5d68d31711288e1fe0fa17dbf4f}{EXIT}}), \mbox{\hyperlink{structCode}{Code}}(\textcolor{stringliteral}{"nop"},  \mbox{\hyperlink{ceforth_8h_af99290ebc7dc90e2d53b08b8445f90cfaf811bef354b292ff0713c50d7652c026}{NOP}}),   \mbox{\hyperlink{structCode}{Code}}(\textcolor{stringliteral}{"next"}, \mbox{\hyperlink{ceforth_8h_af99290ebc7dc90e2d53b08b8445f90cfab13b96bf99a409e019f70dc1602532fd}{NEXT}}),  \mbox{\hyperlink{structCode}{Code}}(\textcolor{stringliteral}{"loop"}, \mbox{\hyperlink{ceforth_8h_af99290ebc7dc90e2d53b08b8445f90cfa61f7f1587bd5fe978d9ff3ece8d0624c}{LOOP}}),}
\DoxyCodeLine{    \mbox{\hyperlink{structCode}{Code}}(\textcolor{stringliteral}{"lit"}, \mbox{\hyperlink{ceforth_8h_af99290ebc7dc90e2d53b08b8445f90cfa3b759690471ed29ecd243a8f36b93f60}{LIT}}),  \mbox{\hyperlink{structCode}{Code}}(\textcolor{stringliteral}{"var"},  \mbox{\hyperlink{ceforth_8h_af99290ebc7dc90e2d53b08b8445f90cfaf68346ce0bfce7ab2ca0a240f5132863}{VAR}}),   \mbox{\hyperlink{structCode}{Code}}(\textcolor{stringliteral}{"str"},  \mbox{\hyperlink{ceforth_8h_af99290ebc7dc90e2d53b08b8445f90cfaec41e801b43cfbec49d343c900360bf9}{STR}}),   \mbox{\hyperlink{structCode}{Code}}(\textcolor{stringliteral}{"dotq"}, \mbox{\hyperlink{ceforth_8h_af99290ebc7dc90e2d53b08b8445f90cfa095d6c606e30118fcd45095816ebb017}{DOTQ}}),}
\DoxyCodeLine{    \mbox{\hyperlink{structCode}{Code}}(\textcolor{stringliteral}{"bran"},\mbox{\hyperlink{ceforth_8h_af99290ebc7dc90e2d53b08b8445f90cfa0d3163a24760c4c2b59a2ac47b233d43}{BRAN}}), \mbox{\hyperlink{structCode}{Code}}(\textcolor{stringliteral}{"0bran"},\mbox{\hyperlink{ceforth_8h_af99290ebc7dc90e2d53b08b8445f90cfa85aab50c7e8b897e918adf1592b14a2f}{ZBRAN}}), \mbox{\hyperlink{structCode}{Code}}(\textcolor{stringliteral}{"vbran"},\mbox{\hyperlink{ceforth_8h_af99290ebc7dc90e2d53b08b8445f90cfa4aa86be4d9164781812ae616df411e1a}{VBRAN}}), \mbox{\hyperlink{structCode}{Code}}(\textcolor{stringliteral}{"does>"},\mbox{\hyperlink{ceforth_8h_af99290ebc7dc90e2d53b08b8445f90cfabb20064cb680106e5c1c45d02000df9a}{DOES}}),}
\DoxyCodeLine{    \mbox{\hyperlink{structCode}{Code}}(\textcolor{stringliteral}{"for"}, \mbox{\hyperlink{ceforth_8h_af99290ebc7dc90e2d53b08b8445f90cfaa809654855caa62449850d9122fd77a8}{FOR}}),  \mbox{\hyperlink{structCode}{Code}}(\textcolor{stringliteral}{"do"},   \mbox{\hyperlink{ceforth_8h_af99290ebc7dc90e2d53b08b8445f90cfabfea6036e64d9c7c773d277a57d2f959}{DO}}),    \mbox{\hyperlink{structCode}{Code}}(\textcolor{stringliteral}{"key"},  \mbox{\hyperlink{ceforth_8h_af99290ebc7dc90e2d53b08b8445f90cfa147e71049e3285d642d0d5268dba260f}{KEY}})}
\DoxyCodeLine{\}}

\end{DoxyCode}
\mbox{\Hypertarget{ceforth_8cpp_afbbad1e6f5dfbd3664246a4a3a623559}\label{ceforth_8cpp_afbbad1e6f5dfbd3664246a4a3a623559}} 
\index{ceforth.cpp@{ceforth.cpp}!IP@{IP}}
\index{IP@{IP}!ceforth.cpp@{ceforth.cpp}}
\doxysubsubsection{\texorpdfstring{IP}{IP}}
{\footnotesize\ttfamily \mbox{\hyperlink{config_8h_aff5e3e5f0579f9bce7aeaeac9d89d33a}{IU}} IP = 0}



instruction pointer 

\mbox{\Hypertarget{ceforth_8cpp_a170318f415c56c413f6f4b7128d5f108}\label{ceforth_8cpp_a170318f415c56c413f6f4b7128d5f108}} 
\index{ceforth.cpp@{ceforth.cpp}!VM@{VM}}
\index{VM@{VM}!ceforth.cpp@{ceforth.cpp}}
\doxysubsubsection{\texorpdfstring{VM}{VM}}
{\footnotesize\ttfamily \mbox{\hyperlink{ceforth_8cpp_a0f69c35de808703dbcaf85edc29cd4bf}{vm\+\_\+state}} VM = \mbox{\hyperlink{ceforth_8cpp_a0f69c35de808703dbcaf85edc29cd4bfa21043ddfa5289b4cf14cd4e3f5a89b62}{Q\+U\+E\+RY}}}

VM state \mbox{\Hypertarget{ceforth_8cpp_aa6a7d418e86b1d2fb92e4c941bae302a}\label{ceforth_8cpp_aa6a7d418e86b1d2fb92e4c941bae302a}} 
\index{ceforth.cpp@{ceforth.cpp}!tos@{tos}}
\index{tos@{tos}!ceforth.cpp@{ceforth.cpp}}
\doxysubsubsection{\texorpdfstring{tos}{tos}}
{\footnotesize\ttfamily \mbox{\hyperlink{config_8h_a57c78d17a8f015df496afc50c9ab973d}{DU}} tos = -\/\mbox{\hyperlink{config_8h_a8f5350b752d7bf33f51b37b7c8e71abc}{D\+U1}}}



top of stack (cached) 

\begin{quote}
user variables \end{quote}
\mbox{\Hypertarget{ceforth_8cpp_aef05b34af1a92f91c23c8fde1941e5a8}\label{ceforth_8cpp_aef05b34af1a92f91c23c8fde1941e5a8}} 
\index{ceforth.cpp@{ceforth.cpp}!compile@{compile}}
\index{compile@{compile}!ceforth.cpp@{ceforth.cpp}}
\doxysubsubsection{\texorpdfstring{compile}{compile}}
{\footnotesize\ttfamily bool compile = false}



compiler flag 

\mbox{\Hypertarget{ceforth_8cpp_a088210e30aca67b4f3d3808157ce57d7}\label{ceforth_8cpp_a088210e30aca67b4f3d3808157ce57d7}} 
\index{ceforth.cpp@{ceforth.cpp}!upper@{upper}}
\index{upper@{upper}!ceforth.cpp@{ceforth.cpp}}
\doxysubsubsection{\texorpdfstring{upper}{upper}}
{\footnotesize\ttfamily bool upper = false}



case sensitivity control 

\mbox{\Hypertarget{ceforth_8cpp_a5d8850fc43ae60a32d6a9b48d9265fcf}\label{ceforth_8cpp_a5d8850fc43ae60a32d6a9b48d9265fcf}} 
\index{ceforth.cpp@{ceforth.cpp}!load\_dp@{load\_dp}}
\index{load\_dp@{load\_dp}!ceforth.cpp@{ceforth.cpp}}
\doxysubsubsection{\texorpdfstring{load\_dp}{load\_dp}}
{\footnotesize\ttfamily \mbox{\hyperlink{config_8h_aff5e3e5f0579f9bce7aeaeac9d89d33a}{IU}} load\+\_\+dp = 0}



depth of recursive include 

\mbox{\Hypertarget{ceforth_8cpp_a5c4fb4ae8c722cd91ed47503b8aaaded}\label{ceforth_8cpp_a5c4fb4ae8c722cd91ed47503b8aaaded}} 
\index{ceforth.cpp@{ceforth.cpp}!base@{base}}
\index{base@{base}!ceforth.cpp@{ceforth.cpp}}
\doxysubsubsection{\texorpdfstring{base}{base}}
{\footnotesize\ttfamily \mbox{\hyperlink{config_8h_aff5e3e5f0579f9bce7aeaeac9d89d33a}{IU}}$\ast$ base}



numeric radix (a pointer) 

\mbox{\Hypertarget{ceforth_8cpp_ad1fe51c8db7e234768405202eb6cc339}\label{ceforth_8cpp_ad1fe51c8db7e234768405202eb6cc339}} 
\index{ceforth.cpp@{ceforth.cpp}!dflt@{dflt}}
\index{dflt@{dflt}!ceforth.cpp@{ceforth.cpp}}
\doxysubsubsection{\texorpdfstring{dflt}{dflt}}
{\footnotesize\ttfamily \mbox{\hyperlink{config_8h_aff5e3e5f0579f9bce7aeaeac9d89d33a}{IU}}$\ast$ dflt}



use float data unit flag 

\mbox{\Hypertarget{ceforth_8cpp_ab83f60d10ba1fbda9fafd4eb249b9689}\label{ceforth_8cpp_ab83f60d10ba1fbda9fafd4eb249b9689}} 
\index{ceforth.cpp@{ceforth.cpp}!fin@{fin}}
\index{fin@{fin}!ceforth.cpp@{ceforth.cpp}}
\doxysubsubsection{\texorpdfstring{fin}{fin}}
{\footnotesize\ttfamily istringstream fin}



default to C++ standard template library 

forth\+\_\+in \mbox{\Hypertarget{ceforth_8cpp_aa8d01c5367bd4ece39c7443bc4a06663}\label{ceforth_8cpp_aa8d01c5367bd4ece39c7443bc4a06663}} 
\index{ceforth.cpp@{ceforth.cpp}!fout@{fout}}
\index{fout@{fout}!ceforth.cpp@{ceforth.cpp}}
\doxysubsubsection{\texorpdfstring{fout}{fout}}
{\footnotesize\ttfamily ostringstream fout}



forth\+\_\+out 

\mbox{\Hypertarget{ceforth_8cpp_a6e3effe75730089085c31e8396cf80a0}\label{ceforth_8cpp_a6e3effe75730089085c31e8396cf80a0}} 
\index{ceforth.cpp@{ceforth.cpp}!pad@{pad}}
\index{pad@{pad}!ceforth.cpp@{ceforth.cpp}}
\doxysubsubsection{\texorpdfstring{pad}{pad}}
{\footnotesize\ttfamily string pad}



input string buffer 

\mbox{\Hypertarget{ceforth_8cpp_ae601152c2463f358fc585f95817fb315}\label{ceforth_8cpp_ae601152c2463f358fc585f95817fb315}} 
\index{ceforth.cpp@{ceforth.cpp}!fout\_cb@{fout\_cb}}
\index{fout\_cb@{fout\_cb}!ceforth.cpp@{ceforth.cpp}}
\doxysubsubsection{\texorpdfstring{fout\_cb}{fout\_cb}}
{\footnotesize\ttfamily void($\ast$ fout\+\_\+cb) (int, const char $\ast$)}



forth output callback function (see E\+N\+DL macro) 

